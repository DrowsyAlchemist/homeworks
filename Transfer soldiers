using System;
using System.Collections.Generic;
using System.Linq;

namespace Lessons
{
    class Lessons
    {
        public static void Main()
        {
            Squad firstSquad = new Squad(GetSoldiers(5));
            Squad secondSquad = new Squad(GetSoldiers(5));
            PrintSquads(firstSquad, secondSquad);
            firstSquad.TransferSoldiersByLastName(secondSquad, "Б");
            Console.WriteLine("ПОСЛЕ ПЕРЕВОДА:\n");
            PrintSquads(firstSquad, secondSquad);
            Console.ReadKey(true);
        }

        private static List<Soldier> GetSoldiers(int count)
        {
            var soldiers = new List<Soldier>();

            for (int i = 0; i < count; i++)
                soldiers.Add(new Soldier());

            return soldiers;
        }

        private static void PrintSquads(Squad firstSquad, Squad secondSquad)
        {
            Console.WriteLine("Первый отряд:\n");
            firstSquad.PrintSoldiers();
            Console.WriteLine("Второй отряд:\n");
            secondSquad.PrintSoldiers();
        }
    }

    enum SoldierWeapon
    {
        Пистолет,
        Автомат,
        Винтовка,
        Пулемёт,
        Гранатомёт
    }

    enum SoldierRank
    {
        Рядовой,
        Сержант,
        Прапорщк,
        Лейтенант,
        Капитан,
        Майор,
        Полковник
    }

    class Squad
    {
        private List<Soldier> _soldiers;

        public Squad(List<Soldier> soldiers)
        {
            _soldiers = soldiers;
        }

        public void TransferSoldiersByLastName(Squad destinationSquad, string lastnameFirstLetter)
        {
            var result = _soldiers
                .OrderBy(soldier => soldier.Lastname)
                .SkipWhile(soldier => soldier.Lastname.StartsWith(lastnameFirstLetter) == false)
                .TakeWhile(soldier => soldier.Lastname.StartsWith(lastnameFirstLetter));

            foreach (var soldier in result)
            {
                destinationSquad.AddSolder(soldier);
                _soldiers.Remove(soldier);
            }
        }

        public void PrintSoldiers()
        {
            foreach (var soldier in _soldiers)
                soldier.ShowInfo();
        }

        private void AddSolder(Soldier soldier)
        {
            _soldiers.Add(soldier);
        }
    }

    class Soldier
    {
        private const int MaxServiceLife = 60;
        private const int MinServiceLife = 12;
        private static Random _random = new Random();
        private string[] _lastnames =
        {
            "Александров",
            "Батиков",
            "Бобров",
            "Попов",
            "Сидоров",
            "Смирнов",
            "Яковлев",
        };

        public Soldier()
        {
            Lastname = _lastnames[_random.Next(_lastnames.Length)];
            Weapon = GetWeapon();
            Rank = GetRank();
            ServiceLifeInMonths = _random.Next(MinServiceLife, MaxServiceLife + 1);
        }

        public string Lastname { get; private set; }
        public SoldierWeapon Weapon { get; private set; }
        public SoldierRank Rank { get; private set; }
        public int ServiceLifeInMonths { get; private set; }

        public void ShowInfo()
        {
            Console.WriteLine(
                $"Имя солдата: {Lastname}\n" +
                $"Оружие: {Weapon}\n" +
                $"Звание: {Rank}\n" +
                $"Срок службы в месяцах: {ServiceLifeInMonths}\n");
        }

        private SoldierWeapon GetWeapon()
        {
            Array weapons = typeof(SoldierWeapon).GetEnumValues();
            return (SoldierWeapon)_random.Next(weapons.Length);
        }

        private SoldierRank GetRank()
        {
            Array ranks = typeof(SoldierRank).GetEnumValues();
            return (SoldierRank)_random.Next(ranks.Length);
        }
    }
}
