using System;
using System.Collections.Generic;
using System.Linq;

namespace Lessons
{
    class Lessons
    {
        public static void Main()
        {
            List<Player> players = GetPlayers(20);
            Server server = new Server(players);
            string inputDate = string.Empty;

            while (inputDate != "4")
            {
                int topCount = 3;
                Console.Clear();
                Console.WriteLine(
                    $"1. Список всех игроков сервера\n" +
                    $"2. Топ {topCount} игрока по уровню\n" +
                    $"3. Топ {topCount} игрока по силе\n" +
                    $"4. Выйти\n");
                inputDate = Console.ReadLine();
                Console.Clear();

                switch (inputDate)
                {
                    case "1":
                        server.PrintAllPlayers();
                        break;
                    case "2":
                        server.PrintTopPlayersByLevel(topCount);
                        break;
                    case "3":
                        server.PrintTopPlayersByStrength(topCount);
                        break;
                }
                Console.ReadKey(true);
            }
        }

        private static List<Player> GetPlayers(int count)
        {
            var playerCreator = new RandomPlayerCreator();
            var players = new List<Player>();

            for (int i = 0; i < count; i++)
                players.Add(new Player(playerCreator));

            return players;
        }
    }

    class Server
    {
        private List<Player> _players;

        public Server(List<Player> players)
        {
            _players = players;
        }

        public void PrintAllPlayers()
        {
            PrintPlayers(_players);
        }

        public void PrintTopPlayersByLevel(int topCount)
        {
            var result = _players.OrderByDescending(player => player.Level).Take(topCount);
            PrintPlayers(result);
        }

        public void PrintTopPlayersByStrength(int topCount)
        {
            var result = _players.OrderByDescending(player => player.Stength).Take(topCount);
            PrintPlayers(result);
        }

        private void PrintPlayers(IEnumerable<Player> players)
        {
            foreach (Player player in players)
                player.ShowInfo();
        }
    }

    class Player
    {
        public Player(RandomPlayerCreator playerCreator)
        {
            Name = playerCreator.Name;
            Level = playerCreator.Level;
            Stength = playerCreator.Strength;
        }

        public string Name { get; private set; }
        public int Level { get; private set; }
        public int Stength { get; private set; }

        public void ShowInfo()
        {
            Console.WriteLine(
                $"Имя игрока: {Name}\n" +
                $"Уровень: {Level}\n" +
                $"Сила: {Stength}\n");
        }
    }

    class RandomPlayerCreator
    {
        private const int MaxLevel = 100;
        private const int MaxStrength = 50;
        private static Random _random = new Random();
        private string[] _names =
        {
            "Боб",
            "Марк",
            "Майкл",
            "Джордж",
            "Кевин",
            "Дэнис",
            "Анджела",
            "Маргарет",
        };

        public string Name => _names[_random.Next(_names.Length)];
        public int Level => _random.Next(MaxLevel);
        public int Strength => _random.Next(MaxStrength);
    }
}
